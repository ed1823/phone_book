{% extends "base.html" %}

{% block title %}–°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤{% endblock %}

{% block content %}
  <div class="container mx-auto p-6 bg-gray-100 rounded-xl shadow-md">

    <!-- üîç –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
    <form method="get" class="mb-6 flex gap-3">
      <input
        type="text"
        name="search"
        value="{{ query|default:'' }}"
        placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, —Ç–µ–ª–µ—Ñ–æ–Ω—É –∏–ª–∏ email"
        class="flex-1 border border-gray-300 rounded px-4 py-2"
      />
      <button
        type="submit"
        class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
      >
        –ù–∞–π—Ç–∏
      </button>
      {% if query %}
        <a href="{% url 'contact_list' %}" class="text-blue-600 hover:underline mt-2">–°–±—Ä–æ—Å–∏—Ç—å</a>
      {% endif %}
    </form>

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–Ω–æ–ø–∫–∞ -->
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-2xl font-semibold text-gray-800">üìí –ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
      {% if user.is_authenticated %}
        <a href="{% url 'add_contact' %}" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">‚ûï –î–æ–±–∞–≤–∏—Ç—å</a>
      {% endif %}
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ -->
    {% if contacts %}
      <div class="overflow-x-auto rounded-lg shadow">
        <table class="min-w-full bg-white border border-gray-300">
          <thead class="bg-blue-600 text-white">
            <tr>
              <th class="py-3 px-4 text-left">
                –§–ò–û
                <a
                  href="?{% if query %}search={{ query }}&{% endif %}sort=name"
                  title="–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é"
                  class="ml-2 hover:text-gray-200 {% if request.GET.sort == 'name' %}font-bold text-yellow-300{% endif %}"
                >‚Üë</a>
                <a
                  href="?{% if query %}search={{ query }}&{% endif %}sort=-name"
                  title="–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É–±—ã–≤–∞–Ω–∏—é"
                  class="ml-1 hover:text-gray-200 {% if request.GET.sort == '-name' %}font-bold text-yellow-300{% endif %}"
                >‚Üì</a>
              </th>
              <th class="py-3 px-4 text-left">–¢–µ–ª–µ—Ñ–æ–Ω</th>
              <th class="py-3 px-4 text-left">Email</th>
              <th class="py-3 px-4 text-left">–ê–¥—Ä–µ—Å</th>
              <th class="py-3 px-4 text-left">–°–æ–∑–¥–∞–ª</th>
            </tr>
          </thead>
          <tbody class="text-gray-700">
            {% for contact in contacts %}
              <tr class="border-b hover:bg-gray-100">
                <td class="py-3 px-4">{{ contact.name }}</td>
                <td class="py-3 px-4">{{ contact.phone }}</td>
                <td class="py-3 px-4">{{ contact.email }}</td>
                <td class="py-3 px-4">{{ contact.address }}</td>
                <td class="py-3 px-4">{{ contact.user.username }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="text-gray-500">–ö–æ–Ω—Ç–∞–∫—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
    {% endif %}
  </div>
{% endblock %}
